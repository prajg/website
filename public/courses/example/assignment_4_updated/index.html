<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Raj Patel">

  
  
  
    
  
  <meta name="description" content="Question 1 Here, y1, y2, …, yn is a random sample from a Bernoulli distribution where Y ∼ Ber**n(p) with pmf of Y: f(yi|p)=pyi(1 − p)1 − yi; yi ∈ {0, 1; 1 = success}">

  
  <link rel="alternate" hreflang="en-us" href="/courses/example/assignment_4_updated/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/courses/example/assignment_4_updated/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Raj Patel">
  <meta property="og:url" content="/courses/example/assignment_4_updated/">
  <meta property="og:title" content="Assignment 3 | Raj Patel">
  <meta property="og:description" content="Question 1 Here, y1, y2, …, yn is a random sample from a Bernoulli distribution where Y ∼ Ber**n(p) with pmf of Y: f(yi|p)=pyi(1 − p)1 − yi; yi ∈ {0, 1; 1 = success}"><meta property="og:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-05T00:00:00&#43;01:00">
    
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  

  



  


  


  





  <title>Assignment 3 | Raj Patel</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Raj Patel</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Raj Patel</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Work Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#accomplishments"><span>Accomplishments</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/example/">Assignments</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/example/assignment_2_updated/">Assignment 1</a>
      </li>
      
      <li >
        <a href="/courses/example/assignment_3_updated/">Assignment 2</a>
      </li>
      
      <li class="active">
        <a href="/courses/example/assignment_4_updated/">Assignment 3</a>
      </li>
      
      <li >
        <a href="/courses/example/assignment_5_updated/">Assignment 4</a>
      </li>
      
      <li >
        <a href="/courses/example/assignment_6_updated/">Assignment 5</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#question-1">Question 1</a></li>
        <li><a href="#question-2">Question 2:</a></li>
        <li><a href="#question-3">Question 3</a></li>
      </ul>
    </li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Assignment 3</h1>

          <div class="article-style">
            <h3 id="question-1">Question 1</h3>
<p>Here, <em>y</em><sub>1</sub>, <em>y</em><sub>2</sub>, …, <em>y</em><sub><em>n</em></sub> is a random
sample from a Bernoulli distribution where <em>Y</em> ∼ <em>B<strong>e</strong>r**n</em>(<em>p</em>) with
pmf of Y:
<em>f</em>(<em>y</em><sub><em>i</em></sub>|<em>p</em>)=<em>p</em><sup><em>y</em><sub><em>i</em></sub></sup>(1 − <em>p</em>)<sup>1 − <em>y</em><sub><em>i</em></sub></sup>; <em>y</em><sub><em>i</em></sub> ∈ {0, 1; 1 = <em>s<strong>u</strong>c<strong>c</strong>e<strong>s</strong>s</em>}</p>
<h4 id="part-a">Part a:</h4>
<p>Here, we want to find the MLE of p. So, here, the likelihood function
is:
$$ L(p) = \prod_{i = 1}^{n} p^{y_i} (1-p)^{1-y_i} $$
So, from this, log-likelihood is:
$$ l(p) = \log{p} \sum_{i = 1}^{n} y_i + \log{(1-p)} \sum_{i = 1}^{n} (1 - y_i) $$
Now, to find the MLE of p, we set the first derivative of <em>l</em>(<em>p</em>) to
be zero and double check to make sure that the second derivative is
negative.</p>
<p>If we set the first derivative to be zero, we have:
$$ \frac{dl(p)}{dp} = \frac{\sum_{i = 1}^{n} y_i}{p}  - \frac{\sum_{i = 1}^{n} (1 - y_i)}{(1-p)} = 0$$
$$ \therefore \sum_{i = 1}^{n} y_i - p \sum_{i = 1}^{n} y_i = p \sum_{i = 1}^{n} (1-y_i)$$
$$ \therefore \hat{p} = \frac{\sum_{i = 1}^{n} y_i}{n}$$
Now, to make sure that this is the maximum likelihood estimator, we
double check that the second derivative is negative.
$$ \displaystyle \frac{d^2l(p)}{dp^2}  = - \frac {\sum_{i = 1}^{n} y_i}{p^2} - \frac{\sum_{i = 1}^{n} (1-y_i)}{(1-p)^2}$$
Now, here, <em>p</em> ∈ [0, 1] and <em>y</em> ∈ {0, 1}. Therefore, the second
derivative is negative as both the terms will be negative.</p>
<h4 id="part-b">Part b:</h4>
<p>Here, we are given that in five independent Bernoulli trials from above
Bernoulli process, three successes and two failures were observed.
Calculate the maximum likelihood estimates of p in this situation.</p>
<p>From part a, we know that
$\hat{p} = \frac{\sum_{i = 1}^{n} y_i}{n}$.</p>
<p>Here, because we had 3 successes and 2 failures,
$\sum_{i = 1}^{n} y_i = 3$ as in the question, we are given that
1 = <em>s<strong>u</strong>c<strong>c</strong>e<strong>s</strong>s</em> and 0 = <em>f<strong>a</strong>i<strong>l</strong>u<strong>r</strong>e</em>. Also, because
there are 5 trials, we have <em>n</em> = 5.</p>
<p>$$ \therefore \hat{p} = \frac{\sum_{i = 1}^{n} y_i}{n} = \frac{3}{5}$$
.</p>
<h4 id="part-c">Part c:</h4>
<p>Here, we want to plot the log-likelihood for the data in part(b) by
performing a grid search over a set of possible values of p parameter.
Then, we want to add a vertical line to the plot at the value of p that
maximizes the log-likelihood.</p>
<p>Firstly, we will be creating a log-likelihood function. Then, we define
the possible set of values our parameter <em>p</em> can take. Once we have
that, we will find the loglikelihood for all possible parameter values
and then find <em>p</em> for which it is the largest.</p>
<p>While doing all of this, we will plot the log-likelihood function and
then add a vertical line to the plot at the value of <em>p</em> that maximizes
the log-likelihood.</p>
<pre><code># Defining the log-likelihood function
log_lik_func &lt;- function(x, p = 3, n = 5) { p*log(x) + (n-p)*log(1-x)}

# Values our parameter can take
param_values &lt;- seq(0,1, by = 0.2) 

# Finding log-likelihood for all possible values of parameter
val &lt;- sapply(param_values , log_lik_func)
val

## [1]      -Inf -5.274601 -3.770523 -3.365058 -3.888306      -Inf

# Parameter value for which we have maximum log-likelihood
param_values[which.max(val)]

## [1] 0.6

# plot of log-likelihood
curve(log_lik_func, from = 0, to = 1)
points(param_values, val, col = 'blue', pch = 20) 
points(param_values[which.max(val)], val[which.max(val)], col = 'red', pch = 19) 
abline(v = param_values[which.max(val)], col = 'red')
</code></pre>
<p><img src="/img/1c-1.png" /></p>
<h3 id="question-2">Question 2:</h3>
<p>Here, we have a case of simple logistic regression where Y is a binary
dependent variable and X is the predictor variable with sample data
(<em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>),(<em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>),…,(<em>x</em><sub><em>n</em></sub>, <em>y</em><sub><em>n</em></sub>).
Binary outcomes are modelled as Bernoulli trials as in Question 1 above.
Moreover,
<em>f</em>(<em>y</em><sub><em>i</em></sub>|<em>p</em><sub><em>i</em></sub>)=<em>p</em><sub><em>i</em></sub><sup><em>y</em><sub><em>i</em></sub></sup>(1 − <em>p</em><sub><em>i</em></sub>)<sup>1 − <em>y</em><sub><em>i</em></sub></sup>; <em>y</em><sub><em>i</em></sub> ∈ {0, 1; 1 = <em>Y<strong>e</strong>s</em>}
$$ p_i = \frac{e^{{\beta_0}+{\beta_1x_i}}}{1+e^{{\beta_0}+{\beta_1x_i}}} $$</p>
<h4 id="part-a-1">Part a:</h4>
<p>Here, we want to derive the log-likelihood function <em>l</em>(<em>β</em>), where
<em>β</em> = (<em>β</em><sub>0</sub>, <em>β</em><sub>1</sub>).</p>
<p>So, here, firstly our likelihood function is as follows:
$$ L(\beta) = \prod_{i=1}^{n}p_i^{y_i} (1-p_i)^{1-y_i}  $$
So, from this, our log-likelihood function is as follows:
$$
\begin{aligned}
l(\beta_0,\beta_1) &amp;= \sum_{i=1}^{n} y_i \log(p_i) +  \sum_{i=1}^{n} (1-y_i) \log(1 - p_i)  \\<br>
&amp;= \sum_{i=1}^{n} \log(1-p_i) +  \sum_{i=1}^{n} y_i \log\frac{p_i}{(1 - p_i)} \\<br>
&amp;= \sum_{i=1}^{n} \log(1-p_i) +  \sum_{i=1}^{n} y_i (\beta_0 + \beta_1 x_i) \\<br>
&amp;= \sum_{i=1}^{n} \log(1-(\frac{e^{{\beta_0}+{\beta_1x_i}}}{1+e^{{\beta_0}+{\beta_1x_i}}})) +  \sum_{i=1}^{n} y_i (\beta_0 + \beta_1 x_i) \\<br>
&amp;= \sum_{i=1}^{n} \log(\frac{1}{1+e^{{\beta_0}+{\beta_1x_i}}}) +  \sum_{i=1}^{n} y_i (\beta_0 + \beta_1 x_i) \\<br>
&amp;= \sum_{i=1}^{n} \log{1} - \log{(1+e^{{\beta_0}+{\beta_1x_i}}}) +  \sum_{i=1}^{n} y_i (\beta_0 + \beta_1 x_i) \\<br>
\end{aligned}
$$</p>
<p>Now, log1 = 0. So, our log-likelihood function is:
$$ l(\beta_0,\beta_1) = -\sum_{i=1}^{n}\log{(1+e^{{\beta_0}+{\beta_1x_i}}}) +  \sum_{i=1}^{n} y_i (\beta_0 + \beta_1 x_i) $$</p>
<h4 id="part-b-1">Part b:</h4>
<p>Here, we want to write function ll() which calculates the
log-likelihood. For this, we will be using our result from part a.</p>
<p>Here, in the output, we add a negative sign to the function we get from
part a. This is because we will be using this function in optim()
function. Now, optim() minimizes the function by default. But we want
parameters that maximize it.</p>
<p>So, we will be returning &ldquo;-log-likelihood&rdquo; which on minimizing will give
the values of parameter which maximize log-likelihood.</p>
<pre><code>ll &lt;- function(x, y, beta) {
  # parameter 1
  b_0 = beta[1]
  
  # parameter 2
  b_1 = beta[2]
  
  n = length(x)
  t &lt;- replicate(length(x), 0)
  t2 &lt;- replicate(length(x), 0)
  
  # term 1 from the log-likelihood function from part a:
  term_1 = 0
  
  # term 2 from the log-likelihood function from part a:
  term_2 = 0
  
    for(i in 1:n){
      t[i] = -log(1 + exp(b_0 + ((b_1)*x[i])))
      term_1 = term_1 + t[i]
      t2[i] = y[i]*(b_0 + (b_1*x[i]))
      term_2 = term_2 + t2[i]
    }
  
  # This is our log-likelihood function
  log_likelihood &lt;- (term_1 + term_2)
  
  # Later, we will be using this function in optim() function. Now, optim() minimizes the 
  # function by default. So, we will be returning &quot;-log-likelihood&quot; which on minimizing  
  # will give the values of parameter which maximize log-likelihood
  -(term_1 + term_2)
  
}
</code></pre>
<h4 id="part-c-1">Part c:</h4>
<p>Here, using the default dataset in the book, we want to fit a logistic
regression model to predict default given balance as a predictor using
glm().</p>
<pre><code># model generation
glm_mod &lt;- glm(default ~ balance, data = Default, family = binomial)
summary(glm_mod)

## 
## Call:
## glm(formula = default ~ balance, family = binomial, data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2697  -0.1465  -0.0589  -0.0221   3.7589  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.065e+01  3.612e-01  -29.49   &lt;2e-16 ***
## balance      5.499e-03  2.204e-04   24.95   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1596.5  on 9998  degrees of freedom
## AIC: 1600.5
## 
## Number of Fisher Scoring iterations: 8
</code></pre>
<h4 id="part-d">Part d:</h4>
<p>Here, we want to use optim() function together with ll() and initial
parameter estimates as zero to calculate maximum likelihood estimates of
regression coefficients in part c.</p>
<p>In our data, the response variable &ldquo;default&rdquo; is of datatype factor. As a
result, we will first convert that to 0&rsquo;s and 1&rsquo;s with 1 being default
and 0 being non-default.</p>
<p>Following that, we will convert this to a vector as manipulating factors
is a bit tricky.</p>
<p>Finally, we use optim function to find the parameter values which
maximize log-likelihood function starting from (0,0) as the parameter
values. By default, optim function minimizes the function but we wanted
to find parameter values which maximize the log-likelihood. As a result,
we earlier added a negative sign in the output of log-likelihood so that
the result given by optim function fits our requirement.</p>
<pre><code># Convert factor levels to 0 and 1
output_default &lt;- Default$default
levels(output_default)[1]&lt;-&quot;0&quot;
levels(output_default)[2]&lt;-&quot;1&quot;

# Change to a vector
output_default &lt;- as.numeric(as.character(output_default))

# Using optim function on log-likelihood to find parameters, starting from (0,0)
optim(c(0,0), ll,x = Default$balance, y = output_default)

## $par
## [1] -10.652058220   0.005499188
## 
## $value
## [1] 798.2259
## 
## $counts
## function gradient 
##      107       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
</code></pre>
<h4 id="part-e">Part e:</h4>
<p>Based on our outputs from part (c) and part (d), we can say that maximum
likelihood estimates obtained using optim() function are very similar to
the ones obtained using glm() function.</p>
<h4 id="part-f">Part f:</h4>
<p>Here, we want to calculate the standard errors of our estimates. As
provided in the question, we can include parameter option &lsquo;hessian =
TRUE&rsquo; in the function optim() when we call the function optim() in part
d.</p>
<p>But here, , we see that if we invert the Hessian matrix using the
default method in optim, we get negative numbers on the diagonal. So,
taking their square roots will not be possible.</p>
<p>As a result, we will use Quasi Newton method, specifically the &lsquo;BFGS&rsquo;
method as those methods are used when Hessian is unavailable.</p>
<pre><code>Hessian_mat &lt;- optim(c(0,0), ll,x = Default$balance, y = output_default, hessian = TRUE, 
                       method = 'BFGS')$hessian

# Now, we find the inverse of this and then we take the square root of the diagonal.
std_err_est &lt;- sqrt(diag(solve(Hessian_mat)))
std_err_est

## [1] 0.3378529809 0.0002296589
</code></pre>
<h4 id="part-g">Part g:</h4>
<p>Bases on the outputs we have from part (c) and (f), we can say that
standard errors of the MLE obtained using optim() and glm() are very
similar.</p>
<h3 id="question-3">Question 3</h3>
<h4 id="part-a-2">Part a:</h4>
<p>Here, using the summary and glm functions, we want to determine the
estimated standard errors for the coefficients associated with income
and balance in a multiple logistic regression model.</p>
<pre><code>set.seed(100)
fit1 &lt;- glm(default ~ income + balance, data=Default, family=binomial)
summary(fit1)

## 
## Call:
## glm(formula = default ~ income + balance, family = binomial, 
##     data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4725  -0.1444  -0.0574  -0.0211   3.7245  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.154e+01  4.348e-01 -26.545  &lt; 2e-16 ***
## income       2.081e-05  4.985e-06   4.174 2.99e-05 ***
## balance      5.647e-03  2.274e-04  24.836  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1579.0  on 9997  degrees of freedom
## AIC: 1585
## 
## Number of Fisher Scoring iterations: 8

sum_coef &lt;- rbind(summary(fit1)$coef[1:3,1:2])
knitr::kable(sum_coef, caption = &quot;Estimate and Standard Error of the model&quot;)
</code></pre>
<table>
<caption>Estimate and Standard Error of the model</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="right">-11.5404684</td>
<td align="right">0.4347564</td>
</tr>
<tr class="even">
<td>income</td>
<td align="right">0.0000208</td>
<td align="right">0.0000050</td>
</tr>
<tr class="odd">
<td>balance</td>
<td align="right">0.0056471</td>
<td align="right">0.0002274</td>
</tr>
</tbody>
</table>
<p>Therefore, the estimated standard errors for <em>β</em><sub>0</sub> is
<strong>4.347564e-01</strong>, for <em>β</em><sub>1</sub>, which is the coefficient
associated with income, is <strong>4.985167e-06</strong> and that for
<em>β</em><sub>2</sub>, which is the coefficient associated with balance, is
<strong>2.273731e-04</strong></p>
<h4 id="part-b-2">Part b:</h4>
<p>Here, we want to write a function that takes as input the Default data
set as well as index of observations and then outputs the coefficient
estimates for income and balance in the multiple logistic regression
model.</p>
<pre><code>set.seed(100)
boot.fn &lt;- function(data_set, index){
  fit2 &lt;- glm(default ~ income + balance, data=data_set, subset = index, family=binomial)
  return(coef(fit2))
}
</code></pre>
<h4 id="part-c-2">Part c:</h4>
<p>Here, we want to use the boot() function together with our boot.fn() to
estimate the standard errors of the logistic regression coefficients for
income and balance.</p>
<p>For R = 1000 replications</p>
<pre><code>par(mfrow = c(3,2))
set.seed(100)
results &lt;- boot(Default, boot.fn, 1000)
results

## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = Default, statistic = boot.fn, R = 1000)
## 
## 
## Bootstrap Statistics :
##          original        bias     std. error
## t1* -1.154047e+01 -2.927307e-02 4.446538e-01
## t2*  2.080898e-05 -3.481513e-08 4.916633e-06
## t3*  5.647103e-03  1.665079e-05 2.318937e-04
</code></pre>
<p>So, here, standard error for <em>β</em><sub>0</sub> is <strong>4.276469e-01</strong>, for
<em>β</em><sub>1</sub>, which is the coefficient associated with income, is
<strong>4.890019e-06</strong> and that for <em>β</em><sub>2</sub>, which is the coefficient
associated with balance, is <strong>2.250900e-04</strong></p>
<h4 id="part-d-1">Part d:</h4>
<p>Here, we want to comment on the estimated standard errors obtained using
the glm() function and using bootstrap function.</p>
<p>So, based on the results we have, the estimated standard errors obtained
by the two methods are pretty close.</p>

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/example/assignment_3_updated/" rel="next">Assignment 2</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/example/assignment_5_updated/" rel="prev">Assignment 4</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on May 5, 2019</p>

          






  
  

<p class="edit-page">
  <a href="https://github.com/gcushen/hugo-academic/edit/master/content/courses/example/Assignment_4_updated.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          


          


  
  



        </div>

      </article>

      <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    © 2020 Raj Patel
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
