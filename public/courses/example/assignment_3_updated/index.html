<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Raj Patel">

  
  
  
    
  
  <meta name="description" content="Question 1: Part a: Write down what is P(X|Dividend = Yes). P(X|Dividend = Yes), based on the question, follows a normal distribution with mean = 10 and variance = 36.">

  
  <link rel="alternate" hreflang="en-us" href="/courses/example/assignment_3_updated/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/courses/example/assignment_3_updated/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Raj Patel">
  <meta property="og:url" content="/courses/example/assignment_3_updated/">
  <meta property="og:title" content="Assignment 2 | Raj Patel">
  <meta property="og:description" content="Question 1: Part a: Write down what is P(X|Dividend = Yes). P(X|Dividend = Yes), based on the question, follows a normal distribution with mean = 10 and variance = 36."><meta property="og:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-05-05T00:00:00&#43;01:00">
    
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  

  



  


  


  





  <title>Assignment 2 | Raj Patel</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Raj Patel</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Raj Patel</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Work Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#accomplishments"><span>Accomplishments</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/cv.pdf"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/courses/"><span>Courses</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/example/">Assignments</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/example/assignment_2_updated/">Assignment 1</a>
      </li>
      
      <li class="active">
        <a href="/courses/example/assignment_3_updated/">Assignment 2</a>
      </li>
      
      <li >
        <a href="/courses/example/assignment_4_updated/">Assignment 3</a>
      </li>
      
      <li >
        <a href="/courses/example/assignment_5_updated/">Assignment 4</a>
      </li>
      
      <li >
        <a href="/courses/example/assignment_6_updated/">Assignment 5</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/example2/">Overview</a>

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#question-1">Question 1:</a>
      <ul>
        <li><a href="#part-a-write-down-what-is-pxdividend--yes">Part a: Write down what is P(X|Dividend = Yes).</a></li>
        <li><a href="#part-b-write-down-what-is-pxdividend--no">Part b: Write down what is P(X|Dividend = No).</a></li>
        <li><a href="#part-c-use-dnorm-to-calculate-conditional-probabilities-in-a-and-b-when-x4">Part c: Use dnorm() to calculate conditional probabilities in a) and b) when X=4.</a></li>
        <li><a href="#part-d-what-is-the-value-of-pdividend--yes">Part d: What is the value of P(Dividend = Yes)</a></li>
        <li><a href="#part-e-write-down-what-is-pxdividend--no">Part e: Write down what is P(X|Dividend = No).</a></li>
        <li><a href="#part-f-predict-the-probability-that-a-company-will-issue-a-dividend-this-year-given-its-percentage-profit-was-x--4">Part f: Predict the probability that a company will issue a dividend this year given its percentage profit was X = 4.</a></li>
      </ul>
    </li>
    <li><a href="#question-2">Question 2:</a>
      <ul>
        <li><a href="#part-a">Part a:</a></li>
        <li><a href="#part-b">Part b:</a></li>
        <li><a href="#part-c">Part c:</a></li>
        <li><a href="#part-d">Part d:</a></li>
        <li><a href="#part-e">Part e:</a></li>
        <li><a href="#part-f">Part f:</a></li>
      </ul>
    </li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Assignment 2</h1>

          <div class="article-style">
            <h2 id="question-1">Question 1:</h2>
<h3 id="part-a-write-down-what-is-pxdividend--yes">Part a: Write down what is P(X|Dividend = Yes).</h3>
<p>P(X|Dividend = Yes), based on the question, follows a normal
distribution with mean = 10 and variance = 36.</p>
<p>So, it&rsquo;s density would look like:
$$
\begin{aligned}
f(x) &amp;= \frac{1}{\sqrt{2\pi\sigma^2}}exp(-\frac{(x - \mu)^2}{{2\sigma^2}}) \\<br>
&amp;= \frac{1}{\sqrt{2\pi\times 36}}exp(-\frac{1}{{2\sigma^2}}(x - 10)^2)
\end{aligned}
$$</p>
<h3 id="part-b-write-down-what-is-pxdividend--no">Part b: Write down what is P(X|Dividend = No).</h3>
<p>P(X|Dividend = No), based on the question, also follows a normal
distribution with mean = 0 and variance = 36.</p>
<p>So, it&rsquo;s density would look like:
$$
\begin{aligned}
f(x) &amp;= \frac{1}{\sqrt{2\pi\sigma^2}}exp(-\frac{(x - \mu)^2}{{2\sigma^2}}) \\<br>
&amp;= \frac{1}{\sqrt{2\pi\times 36}}exp(-\frac{x^2}{{2\sigma^2}})
\end{aligned}
$$</p>
<h3 id="part-c-use-dnorm-to-calculate-conditional-probabilities-in-a-and-b-when-x4">Part c: Use dnorm() to calculate conditional probabilities in a) and b) when X=4.</h3>
<p>Here, we will firstly calculate conditional probability for part(a) when
X=4.</p>
<pre><code>dnorm(4, mean = 10, sd = 6, log = FALSE)

## [1] 0.04032845
</code></pre>
<p>Based on this, we see that the conditional probability in (a) when X=4
is <strong>0.04032845</strong>. Now, we will be calculating conditional probability
for part(b) when X=4.</p>
<pre><code>dnorm(4, mean = 0, sd = 6, log = FALSE)

## [1] 0.05324133
</code></pre>
<p>Based on this, we see that the conditional probability in (b) when X=4
is <strong>0.05324133</strong>.</p>
<h3 id="part-d-what-is-the-value-of-pdividend--yes">Part d: What is the value of P(Dividend = Yes)</h3>
<p>Based on the question, we are given that 80% of the companies issue
dividends. So, P(Dividend = Yes) = 0.8</p>
<h3 id="part-e-write-down-what-is-pxdividend--no">Part e: Write down what is P(X|Dividend = No).</h3>
<p>Based on the question, we know that 20% of the companies do not issue
dividends. So, P(Dividend = No) = 0.2</p>
<h3 id="part-f-predict-the-probability-that-a-company-will-issue-a-dividend-this-year-given-its-percentage-profit-was-x--4">Part f: Predict the probability that a company will issue a dividend this year given its percentage profit was X = 4.</h3>
<p>Based on part (c), (d) and (e), we will predict the probability that a
company will issue a dividend this year given its percentage profit was
X = 4. To do this, we will be using Bayes&rsquo; rule. Based on that, we get
probability = 0.752.</p>
<p>$$
\begin{aligned}
p_{yes}(x) &amp;= \frac{\pi_{yes}exp(-\frac{(x - \mu_{yes})^2}{{2\sigma^2}})}{\pi_{yes}exp(-\frac{(x - \mu_{yes})^2}{{2\sigma^2}}) + \pi_{no}exp(-\frac{(x - \mu_{no})^2}{{2\sigma^2}})} \\<br>
&amp;= \frac{0.8 \times 0.04032845}{0.8 \times 0.04032845 + 0.2 \times 0.05324133}\\<br>
&amp;= 0.752
\end{aligned}
$$</p>
<h2 id="question-2">Question 2:</h2>
<h3 id="part-a">Part a:</h3>
<p>Here, we want to create a binary variable, mpg01, that contains a 1 if
mpg contains a value above its median, and a 0 if mpg contains a value
below its median.</p>
<pre><code># Check the first five entries of the dataset to see if the dataset is loaded properly
knitr::kable(head(Auto)) 
</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">mpg</th>
<th align="right">cylinders</th>
<th align="right">displacement</th>
<th align="right">horsepower</th>
<th align="right">weight</th>
<th align="right">acceleration</th>
<th align="right">year</th>
<th align="right">origin</th>
<th align="left">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">18</td>
<td align="right">8</td>
<td align="right">307</td>
<td align="right">130</td>
<td align="right">3504</td>
<td align="right">12.0</td>
<td align="right">70</td>
<td align="right">1</td>
<td align="left">chevrolet chevelle malibu</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">8</td>
<td align="right">350</td>
<td align="right">165</td>
<td align="right">3693</td>
<td align="right">11.5</td>
<td align="right">70</td>
<td align="right">1</td>
<td align="left">buick skylark 320</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">8</td>
<td align="right">318</td>
<td align="right">150</td>
<td align="right">3436</td>
<td align="right">11.0</td>
<td align="right">70</td>
<td align="right">1</td>
<td align="left">plymouth satellite</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">8</td>
<td align="right">304</td>
<td align="right">150</td>
<td align="right">3433</td>
<td align="right">12.0</td>
<td align="right">70</td>
<td align="right">1</td>
<td align="left">amc rebel sst</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">8</td>
<td align="right">302</td>
<td align="right">140</td>
<td align="right">3449</td>
<td align="right">10.5</td>
<td align="right">70</td>
<td align="right">1</td>
<td align="left">ford torino</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">8</td>
<td align="right">429</td>
<td align="right">198</td>
<td align="right">4341</td>
<td align="right">10.0</td>
<td align="right">70</td>
<td align="right">1</td>
<td align="left">ford galaxie 500</td>
</tr>
</tbody>
</table>
<pre><code># Creating a variable &quot;mpg01&quot; whose value is 1 if the corresponding mpg value is greater
# than median mpg value and 0 if less than the median 
mpg01 &lt;- rep(0, length(Auto$mpg))
mpg01[Auto$mpg &gt; median(Auto$mpg)] &lt;- 1

# Merging the &quot;mpg01&quot; variable with other variables in the Auto dataset
Auto &lt;- data.frame(Auto, mpg01)
</code></pre>
<h3 id="part-b">Part b:</h3>
<p>Here, we want to see which continuous features seem most likely to be
useful in predicting the mpg. We are provided in the question that we
should use cor() function here and consider features with correlation
coefficient greater than 0.6 in predicting.</p>
<pre><code># Because we can use cor() function only on numeric values, we remove the 9th column, 
# which is the &quot;Names&quot; of the vehicles/cars
A &lt;- cor(Auto[,-9])
A

##                     mpg  cylinders displacement horsepower     weight
## mpg           1.0000000 -0.7776175   -0.8051269 -0.7784268 -0.8322442
## cylinders    -0.7776175  1.0000000    0.9508233  0.8429834  0.8975273
## displacement -0.8051269  0.9508233    1.0000000  0.8972570  0.9329944
## horsepower   -0.7784268  0.8429834    0.8972570  1.0000000  0.8645377
## weight       -0.8322442  0.8975273    0.9329944  0.8645377  1.0000000
## acceleration  0.4233285 -0.5046834   -0.5438005 -0.6891955 -0.4168392
## year          0.5805410 -0.3456474   -0.3698552 -0.4163615 -0.3091199
## origin        0.5652088 -0.5689316   -0.6145351 -0.4551715 -0.5850054
## mpg01         0.8369392 -0.7591939   -0.7534766 -0.6670526 -0.7577566
##              acceleration       year     origin      mpg01
## mpg             0.4233285  0.5805410  0.5652088  0.8369392
## cylinders      -0.5046834 -0.3456474 -0.5689316 -0.7591939
## displacement   -0.5438005 -0.3698552 -0.6145351 -0.7534766
## horsepower     -0.6891955 -0.4163615 -0.4551715 -0.6670526
## weight         -0.4168392 -0.3091199 -0.5850054 -0.7577566
## acceleration    1.0000000  0.2903161  0.2127458  0.3468215
## year            0.2903161  1.0000000  0.1815277  0.4299042
## origin          0.2127458  0.1815277  1.0000000  0.5136984
## mpg01           0.3468215  0.4299042  0.5136984  1.0000000

library(corrplot)
corrplot(A, type=&quot;full&quot;, method = &quot;color&quot;)
</code></pre>
<p><img src="/img/2b-1.png" alt="Correlation plot"  /></p>
<p class="caption">
Correlation plot
</p>
<p>Based on the correlation table and the figure, we can say that
&ldquo;cylinders&rdquo;, &ldquo;displacement&rdquo;, &ldquo;horsepower&rdquo; and &ldquo;weight&rdquo; are four features
that we will be using for prediction as their absolute correlation
coefficient is greater than 0.6.</p>
<p>Just to confirm the impact of the features above, we plot individual box
plots which confirm the same.</p>
<pre><code>par(mfrow=c(2,2))
boxplot(Auto$cylinders ~ Auto$mpg01, main = &quot;Cylinders vs mpg01&quot;)
boxplot(Auto$displacement ~ Auto$mpg01, main = &quot;Displacement vs mpg01&quot;)
boxplot(Auto$horsepower ~ Auto$mpg01, main = &quot;Horsepower vs mpg01&quot;)
boxplot(Auto$weight ~ Auto$mpg01, main = &quot;Weight vs mpg01&quot;)
</code></pre>
<p><img src="/img/2bs-1.png" alt="Box-plots of features to be used in prediction" /></p>
<p class="caption">
Box-plots of features to be used in prediction
</p>
<h3 id="part-c">Part c:</h3>
<p>Here, we want to split the data into training and test set, holding 30%
for the test set. So, for that, we use the sample.split function and
then store them in Auto.train and Auto.test respectively.</p>
<pre><code>set.seed(101)
temp  &lt;- sample.split(Auto, SplitRatio = 0.7)
Auto.train &lt;- Auto[temp,]
Auto.test &lt;- Auto[!temp,]
</code></pre>
<h3 id="part-d">Part d:</h3>
<p>Here, we want to perform LDA using the variables that seemed most
associated in part b and then want to find the test error.</p>
<pre><code>set.seed(101)
# Fitting the LDA model
mod_lda &lt;- lda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto.train)
mod_lda

## Call:
## lda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto.train)
## 
## Prior probabilities of groups:
##         0         1 
## 0.4981818 0.5018182 
## 
## Group means:
##   cylinders   weight displacement horsepower
## 0  6.678832 3605.263     269.2482  129.30657
## 1  4.224638 2357.543     118.4312   79.65217
## 
## Coefficients of linear discriminants:
##                       LD1
## cylinders    -0.289911365
## weight       -0.001216868
## displacement -0.002048940
## horsepower    0.004664771

# Predicting based on the fitted LDA model
pred.lda &lt;- predict(mod_lda, Auto.test)

# Generating the confusion matrix to check the error rate.
table(pred.lda$class, Auto.test[,&quot;mpg01&quot;])

##    
##      0  1
##   0 51  1
##   1  8 57

mean(pred.lda$class != Auto.test[,&quot;mpg01&quot;])

## [1] 0.07692308
</code></pre>
<p>Based on this, we can say that the test error is <strong>7.69%</strong> in the case
of using LDA on features selected in part b.</p>
<h3 id="part-e">Part e:</h3>
<p>Here, we want to perform QDA using the variables that seemed most
associated in part b and then want to find the test error.</p>
<pre><code>set.seed(101)
# Fitting the LDA model
mod_qda &lt;- qda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto.train)
mod_qda

## Call:
## qda(mpg01 ~ cylinders + weight + displacement + horsepower, data = Auto.train)
## 
## Prior probabilities of groups:
##         0         1 
## 0.4981818 0.5018182 
## 
## Group means:
##   cylinders   weight displacement horsepower
## 0  6.678832 3605.263     269.2482  129.30657
## 1  4.224638 2357.543     118.4312   79.65217

# Predicting based on the fitted LDA model
pred.qda &lt;- predict(mod_qda, Auto.test)

# Generating the confusion matrix to check the error rate.
table(pred.qda$class, Auto.test[,&quot;mpg01&quot;])

##    
##      0  1
##   0 54  1
##   1  5 57

mean(pred.qda$class != Auto.test[,&quot;mpg01&quot;])

## [1] 0.05128205
</code></pre>
<p>Based on this, we can say that the test error is <strong>5.12%</strong> in the case
of using QDA on features selected in part b.</p>
<h3 id="part-f">Part f:</h3>
<pre><code>set.seed(101)
glm_mod &lt;- glm(mpg01 ~ cylinders + weight + displacement + horsepower, 
               data = Auto.train, family = binomial)
summary(glm_mod)

## 
## Call:
## glm(formula = mpg01 ~ cylinders + weight + displacement + horsepower, 
##     family = binomial, data = Auto.train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3047  -0.2763   0.1173   0.3913   3.1478  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  10.6027057  1.8659851   5.682 1.33e-08 ***
## cylinders     0.2606786  0.3991895   0.653  0.51374    
## weight       -0.0020693  0.0007444  -2.780  0.00544 ** 
## displacement -0.0136283  0.0092348  -1.476  0.14001    
## horsepower   -0.0383627  0.0156556  -2.450  0.01427 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 381.23  on 274  degrees of freedom
## Residual deviance: 162.40  on 270  degrees of freedom
## AIC: 172.4
## 
## Number of Fisher Scoring iterations: 7

set.seed(101)
# getting the predicted probabilities
probs &lt;- predict(glm_mod, Auto.test, type = &quot;response&quot;) 

# creating the confusion matrix
pred.glm &lt;- rep(0, length(probs))
pred.glm[probs &gt; 0.5] &lt;- 1
table(pred.glm, Auto.test$mpg01)

##         
## pred.glm  0  1
##        0 53  2
##        1  6 56

mean(pred.glm != Auto.test$mpg01)

## [1] 0.06837607
</code></pre>
<p>Based on this, we can say that the test error is <strong>6.84%</strong> in the case
of using Logistic Regression on features selected in part b.</p>
<pre><code>set.seed(101)
library(class)
train.X = cbind(Auto.train$cylinders, Auto.train$weight, 
                Auto.train$displacement, Auto.train$horsepower)
test.X = cbind(Auto.test$cylinders, Auto.test$weight, 
               Auto.test$displacement, Auto.test$horsepower)
train.Y = Auto.train$mpg01
test.Y = Auto.test$mpg01
knn_test_error = c();
for ( i in 1:200 ) {
  knn.pred = knn(train.X, test.X, train.Y, k = i)
  knn_test_error[i] = mean(knn.pred != test.Y)*100
}
plot(1:200, knn_test_error, xlab = &quot;K&quot;, ylab = &quot;Test Error Rate (%)&quot;)
</code></pre>
<p><img src="/img/2g-1.png" /></p>
<pre><code>df &lt;- data.frame(matrix(ncol = 2, nrow = 10))
x &lt;- c(&quot;K&quot;, &quot;Error&quot;)
colnames(df) &lt;- x

temp_vec &lt;- c(1,5,10,15,20,30,50,100,150,200)
for(i in 1:10){
   df[i,1] &lt;- temp_vec[i]
}

for(j in 1:10){
  df[j,2] &lt;- knn_test_error[temp_vec[j]]
}

knitr::kable(df, digits = 3)
</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">K</th>
<th align="right">Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">11.111</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">9.402</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">10.256</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">10.256</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">10.256</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">8.547</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">9.402</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">9.402</td>
</tr>
<tr class="odd">
<td align="right">150</td>
<td align="right">9.402</td>
</tr>
<tr class="even">
<td align="right">200</td>
<td align="right">11.966</td>
</tr>
</tbody>
</table>
<pre><code>which.min(knn_test_error)

## [1] 7

min(knn_test_error)

## [1] 7.692308
</code></pre>
<p>So, from the values provided in question, based on the above table, we
see that KNN performs best for K=30 with test error rate of <strong>8.547%</strong>.</p>
<p>However, if we take all values from 1 to 200, when K = 7, KNN classifier
performs the best with the test error rate = <strong>7.69%</strong>.</p>

          </div>

          



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/example/example1/" rel="next">Assignment 1</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/example/assignment_4_updated/" rel="prev">Assignment 3</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on May 5, 2019</p>

          






  
  

<p class="edit-page">
  <a href="https://github.com/gcushen/hugo-academic/edit/master/content/courses/example/Assignment_3_updated.md">
    <i class="fas fa-pen pr-2"></i>Edit this page
  </a>
</p>




          


          


  
  



        </div>

      </article>

      <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    © 2020 Raj Patel
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
